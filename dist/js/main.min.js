function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){var n;if(t)return"string"==typeof t?_arrayLikeToArray(t,e):"Map"===(n="Object"===(n={}.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=Array(e);n<e;n++)o[n]=t[n];return o}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}document.addEventListener("DOMContentLoaded",function(){console.log("XLSX:","undefined"==typeof XLSX?"undefined":_typeof(XLSX));var o,s=document.getElementById("task-form"),a=document.getElementById("task-list"),t=document.querySelector(".completed-tasks"),r=document.getElementById("completed-task-list"),e=document.getElementById("view-completed-tasks"),n=document.getElementById("back-to-active-tasks"),i=document.getElementById("filter-status"),c=document.getElementById("sort-tasks"),l=document.getElementById("delete-all-tasks"),u=document.getElementById("export-to-excel"),d=[];function m(t,e){var n;o.readyState===WebSocket.OPEN?(n={type:"updateTasks",action:t,task:e},console.log("Sending message to server:",n),o.send(JSON.stringify(n))):console.warn("WebSocket is not open. Message not sent:",{action:t,task:e}),console.log("Attempting to send message:",{action:t,task:e})}function p(){a.innerHTML="",r.innerHTML="";var o=i.value,n=c.value;_toConsumableArray(d).sort(function(t,e){return"attention"===t.status&&"attention"!==e.status?-1:"attention"===e.status&&"attention"!==t.status?1:"attention"===t.status&&"attention"===e.status?new Date(t.attentionAt)-new Date(e.attentionAt):"unitNumber"===n?t.unitNumber.localeCompare(e.unitNumber):"created"===n?t.id-e.id:0}).forEach(function(t){var e,n;"all"!==o&&t.status!==o||("completed"===t.status?(e=t,(n=document.createElement("li")).dataset.id=e.id,n.classList.add("completed"),n.innerHTML="\n            <span><strong>".concat(e.unitNumber,"</strong> - ").concat(e.location,"</span>\n            <span>").concat(e.action," → ").concat(e.destination,"</span>\n            <span>").concat(e.message||"No message",'</span>\n            <button class="restore-btn">Restore</button>\n        '),r.appendChild(n)):(e=t,(n=document.createElement("li")).dataset.id=e.id,n.classList.add(e.status),n.innerHTML="\n            <span><strong>".concat(e.unitNumber,"</strong> - ").concat(e.location,"</span>\n            <span>").concat(e.action," → ").concat(e.destination,"</span>\n            <span>").concat(e.message||"No message",'</span>\n            <div>\n                <button class="edit-message-btn">Edit Message</button>\n                <button class="in-progress-btn">In Progress</button>\n                <button class="completed-btn">Complete</button>\n                <button class="attention-btn">Attention</button>\n            </div>\n        '),a.appendChild(n)))})}!function t(){(o=new WebSocket("wss://hermesapp.online/")).onopen=function(){console.log("Connected to WebSocket server.")},o.onmessage=function(t){var e,n,t=JSON.parse(t.data);console.log("Received message:",t),"initialSync"===t.type?(d=t.tasks,p()):"updateTasks"===t.type&&(e=t.action,n=t.task,-1!==(t=d.findIndex(function(t){return t.id===n.id}))?d[t]=n:"add"===e&&d.push(n),p())},o.onerror=function(t){console.error("WebSocket error:",t)},o.onclose=function(){console.log("WebSocket connection closed. Retrying in 3 seconds..."),setTimeout(t,3e3)}}(),s.addEventListener("submit",function(t){t.preventDefault();var t=document.getElementById("unit-number").value.trim(),e=document.getElementById("location").value.trim(),n=document.getElementById("action").value,o=document.getElementById("destination").value.trim(),a=document.getElementById("message").value.trim();t&&e&&n&&o?(t={id:Date.now().toString(),unitNumber:t,location:e,action:n,destination:o,message:a,status:"neutral",startedAt:null,completedAt:null,duration:null},console.log("New task to add:",t),d.push(t),m("add",t),p(),s.reset()):alert("All required fields must be filled out.")}),u.addEventListener("click",function(){console.log("Export button clicked");var t,e=d.filter(function(t){return"completed"===t.status});0===e.length?alert("No completed tasks to export."):(e=e.map(function(t){return{"Unit Number":t.unitNumber,Location:t.location,Action:t.action,Destination:t.destination,Message:t.message||"No message",Status:t.status,"Started At":t.startedAt||"Not started","Completed At":t.completedAt||"Not completed",Duration:t.duration||"N/A"}}),t=XLSX.utils.book_new(),e=XLSX.utils.json_to_sheet(e),XLSX.utils.book_append_sheet(t,e,"Completed Tasks"),XLSX.writeFile(t,"Completed_Tasks_Report.xlsx"))}),e.addEventListener("click",function(){document.querySelector(".task-list").style.display="none",t.style.display="block"}),n.addEventListener("click",function(){t.style.display="none",document.querySelector(".task-list").style.display="block"}),a.addEventListener("click",function(t){var e,t=t.target,n=t.closest("li").dataset.id,o=d.find(function(t){return t.id===n});o&&(t.classList.contains("edit-message-btn")?null!==(e=prompt("Enter new message:",o.message||""))&&(o.message=e.trim(),m("update",o),p()):t.classList.contains("in-progress-btn")?(o.status="in-progress"===o.status?"neutral":"in-progress","in-progress"!==o.status||o.startedAt||(o.startedAt=(new Date).toISOString()),m("update",o),p()):t.classList.contains("completed-btn")?(o.status="completed",o.completedAt=(new Date).toISOString(),o.startedAt&&(e=Math.round((new Date(o.completedAt)-new Date(o.startedAt))/6e4),o.duration="".concat(e," min")),m("update",o),p()):t.classList.contains("attention-btn")&&(o.status="attention"===o.status?"neutral":"attention",m("update",o),p()))}),r.addEventListener("click",function(t){var e,t=t.target;t.classList.contains("restore-btn")&&(e=t.closest("li").dataset.id,t=d.find(function(t){return t.id===e}))&&(t.status="neutral",m("update",t),p())}),l.addEventListener("click",function(){confirm("Are you sure you want to delete all tasks? This action cannot be undone.")&&(d=[],m("clear",null),p())})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiY29uc29sZSIsImxvZyIsIlhMU1giLCJfdHlwZW9mIiwic29ja2V0IiwidGFza0Zvcm0iLCJnZXRFbGVtZW50QnlJZCIsInRhc2tMaXN0IiwiY29tcGxldGVkVGFza3NTZWN0aW9uIiwicXVlcnlTZWxlY3RvciIsImNvbXBsZXRlZFRhc2tMaXN0Iiwidmlld0NvbXBsZXRlZFRhc2tzQnRuIiwic29ydFRhc2tzIiwiZGVsZXRlQWxsVGFza3NCdG4iLCJ0YXNrcyIsImNvbm5lY3RXZWJTb2NrZXQiLCJhY3Rpb24iLCJ0YXNrIiwibWVzc2FnZSIsInJlYWR5U3RhdGUiLCJXZWJTb2NrZXQiLCJPUEVOIiwidHlwZSIsInJlbmRlckFsbFRhc2tzIiwiaW5uZXJIVE1MIiwiZmlsdGVyIiwiZmlsdGVyU3RhdHVzIiwidmFsdWUiLCJzb3J0QnkiLCJzb3J0IiwiYSIsImIiLCJzdGF0dXMiLCJzb3J0ZWRUYXNrcyIsIl90b0NvbnN1bWFibGVBcnJheSIsIkRhdGUiLCJhdHRlbnRpb25BdCIsInVuaXROdW1iZXIiLCJsb2NhbGVDb21wYXJlIiwiaWQiLCJmb3JFYWNoIiwiY3JlYXRlRWxlbWVudCIsImRhdGFzZXQiLCJjb21wbGV0ZWRUYXNrcyIsImxpIiwiY2xhc3NMaXN0IiwiY29uY2F0IiwibG9jYXRpb24iLCJkZXN0aW5hdGlvbiIsImFwcGVuZENoaWxkIiwicmVuZGVyQ29tcGxldGVkVGFzayIsInJlbmRlclRhc2siLCJleHBvcnRUb0V4Y2VsQnRuIiwib25vcGVuIiwiZXZlbnQiLCJkYXRhIiwib25tZXNzYWdlIiwiSlNPTiIsImZpbmRJbmRleCIsInQiLCJleGlzdGluZ1Rhc2tJbmRleCIsIm9uZXJyb3IiLCJwdXNoIiwiZXJyb3IiLCJvbmNsb3NlIiwic2V0VGltZW91dCIsInByZXZlbnREZWZhdWx0IiwidHJpbSIsInN0YXJ0ZWRBdCIsImNvbXBsZXRlZEF0IiwiZHVyYXRpb24iLCJuZXdUYXNrIiwic3luY1dpdGhTZXJ2ZXIiLCJyZXNldCIsImFsZXJ0IiwiU3RhdHVzIiwid29ya2Jvb2siLCJleGNlbERhdGEiLCJib29rX2FwcGVuZF9zaGVldCIsIndvcmtzaGVldCIsIlVuaXQgTnVtYmVyIiwiTG9jYXRpb24iLCJBY3Rpb24iLCJEZXN0aW5hdGlvbiIsIlN0YXJ0ZWQgQXQiLCJkaXNwbGF5IiwiQ29tcGxldGVkIEF0IiwiYmFja1RvQWN0aXZlVGFza3NCdG4iLCJ1dGlscyIsImJvb2tfbmV3IiwianNvbl90b19zaGVldCIsImZpbmQiLCJ0YXNrSWQiLCJzdHlsZSIsIm5ld01lc3NhZ2UiLCJjb250YWlucyIsInRhcmdldCIsImNsb3Nlc3QiLCJ0b0lTT1N0cmluZyIsInByb21wdCIsImR1cmF0aW9uSW5NaW51dGVzIiwiTWF0aCIsInJvdW5kIiwiY29uZmlybSJdLCJtYXBwaW5ncyI6InVyQ0FBQUEsU0FBU0MsaUJBQWlCLG1CQUFvQixXQUM3Q0MsUUFBUUMsSUFBSSxRQUFvQixhQUFiLE9BQVNDLEtBQUksWUFBQUMsUUFBSkQsSUFBSSxDQUFBLEVBR2hDLElBTUFFLEVBTk1DLEVBQVdQLFNBQVNRLGVBQWUsV0FBVyxFQUM5Q0MsRUFBV1QsU0FBU1EsZUFBZSxXQUFXLEVBQzlDRSxFQUF3QlYsU0FBU1csY0FBYyxrQkFBa0IsRUFDakVDLEVBQW9CWixTQUFTUSxlQUFlLHFCQUFxQixFQUNqRUssRUFBd0JiLFNBQVNRLGVBQWUsc0JBQXNCLEVBUjdFUixFQUEwQkEsU0FBQVEsZUFBb0Isc0JBQU0sRUFDbkROLEVBQW1CRixTQUFTSSxlQUFJLGVBQUEsRUFVMUJVLEVBQVlkLFNBQVNRLGVBQWUsWUFBWSxFQVJ0RE8sRUFBQWYsU0FBQVEsZUFBQSxrQkFBQSxFQUNNRCxFQUFvQkMsU0FBQUEsZUFBZSxpQkFBWSxFQUdyRFEsRUFBTUosR0F1RE4sU0FIQUssRUFBa0JDLEVBQUFDLEdBSWpCLElBRkRDLEVBRUtkLEVBQU9lLGFBQWVDLFVBQVVDLE1BRnJDSCxFQUFBLENB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LFNBQUEsYUFBQSxJQUNYdkIsRUFBQUEsRUFBZXlCLFFBQVMsSUFBTSxFQUFBdkQsUUFBQUgsR0FDOUJoQixFQUFBQSxFQUFnQm9FLEtBQUEsU0FBQWhDLEdBQUEsT0FBQUEsRUFBQXBCLEtBQUFxRCxDQUFBLENBQUEsS0FHakIzRSxFQUFBZSxPQUFBLFVBZEV3QyxFQUFlLFNBQVV2RCxDQUFJLEVBQzdCTSxFQUFlLEVBR2xCLENBQUMsRUFHRFYsRUFBa0JkLGlCQUFpQixRQUFTLFdBQ3ZDd0csUUFBUSwwRUFBMEUsSUFDckZ6RixFQUFRLEdBQ1IwRCxFQUFlLFFBQVMsSUFBSSxFQUM1QmpELEVBQWUsRUFFakIsQ0FBQyxDQUNGLENBQUMiLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4ge1xuXHRjb25zb2xlLmxvZygnWExTWDonLCB0eXBlb2YgWExTWClcblxuXHQvLyBTZWxlY3QgRE9NIGVsZW1lbnRzXG5cdGNvbnN0IHRhc2tGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2stZm9ybScpXG5cdGNvbnN0IHRhc2tMaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2stbGlzdCcpXG5cdGNvbnN0IGNvbXBsZXRlZFRhc2tzU2VjdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb21wbGV0ZWQtdGFza3MnKVxuXHRjb25zdCBjb21wbGV0ZWRUYXNrTGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb21wbGV0ZWQtdGFzay1saXN0Jylcblx0Y29uc3Qgdmlld0NvbXBsZXRlZFRhc2tzQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZXctY29tcGxldGVkLXRhc2tzJylcblx0Y29uc3QgYmFja1RvQWN0aXZlVGFza3NCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmFjay10by1hY3RpdmUtdGFza3MnKVxuXHRjb25zdCBmaWx0ZXJTdGF0dXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsdGVyLXN0YXR1cycpXG5cdGNvbnN0IHNvcnRUYXNrcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzb3J0LXRhc2tzJylcblx0Y29uc3QgZGVsZXRlQWxsVGFza3NCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVsZXRlLWFsbC10YXNrcycpIC8vIERlbGV0ZSBBbGwgVGFza3MgQnV0dG9uXG5cdGNvbnN0IGV4cG9ydFRvRXhjZWxCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhwb3J0LXRvLWV4Y2VsJykgLy8gRXhwb3J0IHRvIEV4Y2VsIEJ1dHRvblxuXG5cdC8vIEluaXRpYWxpemUgYW4gZW1wdHkgYXJyYXkgdG8gc3RvcmUgdGFza3Ncblx0bGV0IHRhc2tzID0gW11cblxuXHQvLyBDb25uZWN0IHRvIFdlYlNvY2tldCBzZXJ2ZXJcblx0bGV0IHNvY2tldFxuXG5cdGZ1bmN0aW9uIGNvbm5lY3RXZWJTb2NrZXQoKSB7XG5cdFx0c29ja2V0ID0gbmV3IFdlYlNvY2tldCgnd3NzOi8vaGVybWVzYXBwLm9ubGluZS8nKVxuXG5cdFx0c29ja2V0Lm9ub3BlbiA9ICgpID0+IHtcblx0XHRcdGNvbnNvbGUubG9nKCdDb25uZWN0ZWQgdG8gV2ViU29ja2V0IHNlcnZlci4nKVxuXHRcdH1cblxuXHRcdHNvY2tldC5vbm1lc3NhZ2UgPSBldmVudCA9PiB7XG5cdFx0XHRjb25zdCBtZXNzYWdlID0gSlNPTi5wYXJzZShldmVudC5kYXRhKVxuXHRcdFx0Y29uc29sZS5sb2coJ1JlY2VpdmVkIG1lc3NhZ2U6JywgbWVzc2FnZSlcblxuXHRcdFx0aWYgKG1lc3NhZ2UudHlwZSA9PT0gJ2luaXRpYWxTeW5jJykge1xuXHRcdFx0XHR0YXNrcyA9IG1lc3NhZ2UudGFza3Ncblx0XHRcdFx0cmVuZGVyQWxsVGFza3MoKVxuXHRcdFx0fSBlbHNlIGlmIChtZXNzYWdlLnR5cGUgPT09ICd1cGRhdGVUYXNrcycpIHtcblx0XHRcdFx0Y29uc3QgeyBhY3Rpb24sIHRhc2sgfSA9IG1lc3NhZ2VcblxuXHRcdFx0XHRjb25zdCBleGlzdGluZ1Rhc2tJbmRleCA9IHRhc2tzLmZpbmRJbmRleCh0ID0+IHQuaWQgPT09IHRhc2suaWQpXG5cdFx0XHRcdGlmIChleGlzdGluZ1Rhc2tJbmRleCAhPT0gLTEpIHtcblx0XHRcdFx0XHR0YXNrc1tleGlzdGluZ1Rhc2tJbmRleF0gPSB0YXNrXG5cdFx0XHRcdH0gZWxzZSBpZiAoYWN0aW9uID09PSAnYWRkJykge1xuXHRcdFx0XHRcdHRhc2tzLnB1c2godGFzaylcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJlbmRlckFsbFRhc2tzKClcblx0XHRcdH1cblx0XHR9XG5cblx0XHRzb2NrZXQub25lcnJvciA9IGVycm9yID0+IHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ1dlYlNvY2tldCBlcnJvcjonLCBlcnJvcilcblx0XHR9XG5cblx0XHRzb2NrZXQub25jbG9zZSA9ICgpID0+IHtcblx0XHRcdGNvbnNvbGUubG9nKCdXZWJTb2NrZXQgY29ubmVjdGlvbiBjbG9zZWQuIFJldHJ5aW5nIGluIDMgc2Vjb25kcy4uLicpXG5cdFx0XHRzZXRUaW1lb3V0KGNvbm5lY3RXZWJTb2NrZXQsIDMwMDApXG5cdFx0fVxuXHR9XG5cblx0Y29ubmVjdFdlYlNvY2tldCgpXG5cblx0Ly8gRnVuY3Rpb24gdG8gc2VuZCBkYXRhIHRvIFdlYlNvY2tldCBzZXJ2ZXJcblx0ZnVuY3Rpb24gc3luY1dpdGhTZXJ2ZXIoYWN0aW9uLCB0YXNrKSB7XG5cdFx0aWYgKHNvY2tldC5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuT1BFTikge1xuXHRcdFx0Y29uc3QgbWVzc2FnZSA9IHtcblx0XHRcdFx0dHlwZTogJ3VwZGF0ZVRhc2tzJyxcblx0XHRcdFx0YWN0aW9uLFxuXHRcdFx0XHR0YXNrLFxuXHRcdFx0fVxuXHRcdFx0Y29uc29sZS5sb2coJ1NlbmRpbmcgbWVzc2FnZSB0byBzZXJ2ZXI6JywgbWVzc2FnZSkgLy8gTG9nIHRoZSBtZXNzYWdlIGJlaW5nIHNlbnRcblx0XHRcdHNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KG1lc3NhZ2UpKVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oJ1dlYlNvY2tldCBpcyBub3Qgb3Blbi4gTWVzc2FnZSBub3Qgc2VudDonLCB7IGFjdGlvbiwgdGFzayB9KVxuXHRcdH1cblx0XHRjb25zb2xlLmxvZygnQXR0ZW1wdGluZyB0byBzZW5kIG1lc3NhZ2U6JywgeyBhY3Rpb24sIHRhc2sgfSlcblx0fVxuXG5cdC8vIEhhbmRsZSBmb3JtIHN1Ym1pc3Npb25cblx0dGFza0Zvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZXZlbnQgPT4ge1xuXHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KClcblxuXHRcdGNvbnN0IHVuaXROdW1iZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndW5pdC1udW1iZXInKS52YWx1ZS50cmltKClcblx0XHRjb25zdCBsb2NhdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2NhdGlvbicpLnZhbHVlLnRyaW0oKVxuXHRcdGNvbnN0IGFjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhY3Rpb24nKS52YWx1ZVxuXHRcdGNvbnN0IGRlc3RpbmF0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rlc3RpbmF0aW9uJykudmFsdWUudHJpbSgpXG5cdFx0Y29uc3QgbWVzc2FnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtZXNzYWdlJykudmFsdWUudHJpbSgpXG5cblx0XHRpZiAoIXVuaXROdW1iZXIgfHwgIWxvY2F0aW9uIHx8ICFhY3Rpb24gfHwgIWRlc3RpbmF0aW9uKSB7XG5cdFx0XHRhbGVydCgnQWxsIHJlcXVpcmVkIGZpZWxkcyBtdXN0IGJlIGZpbGxlZCBvdXQuJylcblx0XHRcdHJldHVyblxuXHRcdH1cblxuXHRcdGNvbnN0IG5ld1Rhc2sgPSB7XG5cdFx0XHRpZDogRGF0ZS5ub3coKS50b1N0cmluZygpLFxuXHRcdFx0dW5pdE51bWJlcixcblx0XHRcdGxvY2F0aW9uLFxuXHRcdFx0YWN0aW9uLFxuXHRcdFx0ZGVzdGluYXRpb24sXG5cdFx0XHRtZXNzYWdlLFxuXHRcdFx0c3RhdHVzOiAnbmV1dHJhbCcsXG5cdFx0XHRzdGFydGVkQXQ6IG51bGwsXG5cdFx0XHRjb21wbGV0ZWRBdDogbnVsbCxcblx0XHRcdGR1cmF0aW9uOiBudWxsLFxuXHRcdH1cblxuXHRcdGNvbnNvbGUubG9nKCdOZXcgdGFzayB0byBhZGQ6JywgbmV3VGFzaykgLy8gTG9nIHRoZSB0YXNrIGJlaW5nIGFkZGVkXG5cblx0XHR0YXNrcy5wdXNoKG5ld1Rhc2spXG5cdFx0c3luY1dpdGhTZXJ2ZXIoJ2FkZCcsIG5ld1Rhc2spXG5cdFx0cmVuZGVyQWxsVGFza3MoKVxuXHRcdHRhc2tGb3JtLnJlc2V0KClcblx0fSlcblxuXHQvLyBSZW5kZXIgYWxsIHRhc2tzXG5cdGZ1bmN0aW9uIHJlbmRlckFsbFRhc2tzKCkge1xuXHRcdHRhc2tMaXN0LmlubmVySFRNTCA9ICcnXG5cdFx0Y29tcGxldGVkVGFza0xpc3QuaW5uZXJIVE1MID0gJydcblxuXHRcdGNvbnN0IGZpbHRlciA9IGZpbHRlclN0YXR1cy52YWx1ZVxuXHRcdGNvbnN0IHNvcnRCeSA9IHNvcnRUYXNrcy52YWx1ZVxuXG5cdFx0Y29uc3Qgc29ydGVkVGFza3MgPSBbLi4udGFza3NdLnNvcnQoKGEsIGIpID0+IHtcblx0XHRcdC8vIDEuIFphZGFuaWEgemUgc3RhdHVzZW0gXCJhdHRlbnRpb25cIiBpZMSFIG5hIGfDs3LEmSB3IGtvbGVqbm/Fm2NpIG5hZGFuaWEgc3RhdHVzdVxuXHRcdFx0aWYgKGEuc3RhdHVzID09PSAnYXR0ZW50aW9uJyAmJiBiLnN0YXR1cyAhPT0gJ2F0dGVudGlvbicpIHJldHVybiAtMVxuXHRcdFx0aWYgKGIuc3RhdHVzID09PSAnYXR0ZW50aW9uJyAmJiBhLnN0YXR1cyAhPT0gJ2F0dGVudGlvbicpIHJldHVybiAxXG5cblx0XHRcdC8vIDIuIEplxZtsaSBvYmEgbWFqxIUgc3RhdHVzIFwiYXR0ZW50aW9uXCIsIHNvcnR1aiB3ZWTFgnVnIG1vbWVudHUgbmFkYW5pYSBzdGF0dXN1XG5cdFx0XHRpZiAoYS5zdGF0dXMgPT09ICdhdHRlbnRpb24nICYmIGIuc3RhdHVzID09PSAnYXR0ZW50aW9uJykge1xuXHRcdFx0XHRyZXR1cm4gbmV3IERhdGUoYS5hdHRlbnRpb25BdCkgLSBuZXcgRGF0ZShiLmF0dGVudGlvbkF0KVxuXHRcdFx0fVxuXG5cdFx0XHQvLyAzLiBSZXN6dGEgemFkYcWEIHdlZMWCdWcgc3RhbmRhcmRvd2VnbyBzb3J0b3dhbmlhXG5cdFx0XHRpZiAoc29ydEJ5ID09PSAndW5pdE51bWJlcicpIHtcblx0XHRcdFx0cmV0dXJuIGEudW5pdE51bWJlci5sb2NhbGVDb21wYXJlKGIudW5pdE51bWJlcilcblx0XHRcdH0gZWxzZSBpZiAoc29ydEJ5ID09PSAnY3JlYXRlZCcpIHtcblx0XHRcdFx0cmV0dXJuIGEuaWQgLSBiLmlkXG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gMFxuXHRcdH0pXG5cblx0XHRzb3J0ZWRUYXNrcy5mb3JFYWNoKHRhc2sgPT4ge1xuXHRcdFx0aWYgKGZpbHRlciA9PT0gJ2FsbCcgfHwgdGFzay5zdGF0dXMgPT09IGZpbHRlcikge1xuXHRcdFx0XHRpZiAodGFzay5zdGF0dXMgPT09ICdjb21wbGV0ZWQnKSB7XG5cdFx0XHRcdFx0cmVuZGVyQ29tcGxldGVkVGFzayh0YXNrKVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJlbmRlclRhc2sodGFzaylcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pXG5cdH1cblxuXHQvLyBSZW5kZXIgaW5kaXZpZHVhbCB0YXNrXG5cdGZ1bmN0aW9uIHJlbmRlclRhc2sodGFzaykge1xuXHRcdGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKVxuXHRcdGxpLmRhdGFzZXQuaWQgPSB0YXNrLmlkXG5cdFx0bGkuY2xhc3NMaXN0LmFkZCh0YXNrLnN0YXR1cylcblxuXHRcdGxpLmlubmVySFRNTCA9IGBcbiAgICAgICAgICAgIDxzcGFuPjxzdHJvbmc+JHt0YXNrLnVuaXROdW1iZXJ9PC9zdHJvbmc+IC0gJHt0YXNrLmxvY2F0aW9ufTwvc3Bhbj5cbiAgICAgICAgICAgIDxzcGFuPiR7dGFzay5hY3Rpb259IOKGkiAke3Rhc2suZGVzdGluYXRpb259PC9zcGFuPlxuICAgICAgICAgICAgPHNwYW4+JHt0YXNrLm1lc3NhZ2UgfHwgJ05vIG1lc3NhZ2UnfTwvc3Bhbj5cbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImVkaXQtbWVzc2FnZS1idG5cIj5FZGl0IE1lc3NhZ2U8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiaW4tcHJvZ3Jlc3MtYnRuXCI+SW4gUHJvZ3Jlc3M8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiY29tcGxldGVkLWJ0blwiPkNvbXBsZXRlPC9idXR0b24+XG4gICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImF0dGVudGlvbi1idG5cIj5BdHRlbnRpb248L2J1dHRvbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICBgXG5cdFx0dGFza0xpc3QuYXBwZW5kQ2hpbGQobGkpXG5cdH1cblxuXHQvLyBSZW5kZXIgaW5kaXZpZHVhbCBjb21wbGV0ZWQgdGFza1xuXHRmdW5jdGlvbiByZW5kZXJDb21wbGV0ZWRUYXNrKHRhc2spIHtcblx0XHRjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJylcblx0XHRsaS5kYXRhc2V0LmlkID0gdGFzay5pZFxuXHRcdGxpLmNsYXNzTGlzdC5hZGQoJ2NvbXBsZXRlZCcpXG5cblx0XHRsaS5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgICA8c3Bhbj48c3Ryb25nPiR7dGFzay51bml0TnVtYmVyfTwvc3Ryb25nPiAtICR7dGFzay5sb2NhdGlvbn08L3NwYW4+XG4gICAgICAgICAgICA8c3Bhbj4ke3Rhc2suYWN0aW9ufSDihpIgJHt0YXNrLmRlc3RpbmF0aW9ufTwvc3Bhbj5cbiAgICAgICAgICAgIDxzcGFuPiR7dGFzay5tZXNzYWdlIHx8ICdObyBtZXNzYWdlJ308L3NwYW4+XG4gICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwicmVzdG9yZS1idG5cIj5SZXN0b3JlPC9idXR0b24+XG4gICAgICAgIGBcblx0XHRjb21wbGV0ZWRUYXNrTGlzdC5hcHBlbmRDaGlsZChsaSlcblx0fVxuXG5cdC8vIEhhbmRsZSBleHBvcnQgdG8gRXhjZWxcblx0ZXhwb3J0VG9FeGNlbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRjb25zb2xlLmxvZygnRXhwb3J0IGJ1dHRvbiBjbGlja2VkJykgLy8gTG9nIHdoZW4gYnV0dG9uIGlzIGNsaWNrZWRcblx0XHRjb25zdCBjb21wbGV0ZWRUYXNrcyA9IHRhc2tzLmZpbHRlcih0YXNrID0+IHRhc2suc3RhdHVzID09PSAnY29tcGxldGVkJylcblxuXHRcdGlmIChjb21wbGV0ZWRUYXNrcy5sZW5ndGggPT09IDApIHtcblx0XHRcdGFsZXJ0KCdObyBjb21wbGV0ZWQgdGFza3MgdG8gZXhwb3J0LicpXG5cdFx0XHRyZXR1cm5cblx0XHR9XG5cblx0XHRjb25zdCBleGNlbERhdGEgPSBjb21wbGV0ZWRUYXNrcy5tYXAodGFzayA9PiAoe1xuXHRcdFx0J1VuaXQgTnVtYmVyJzogdGFzay51bml0TnVtYmVyLFxuXHRcdFx0TG9jYXRpb246IHRhc2subG9jYXRpb24sXG5cdFx0XHRBY3Rpb246IHRhc2suYWN0aW9uLFxuXHRcdFx0RGVzdGluYXRpb246IHRhc2suZGVzdGluYXRpb24sXG5cdFx0XHRNZXNzYWdlOiB0YXNrLm1lc3NhZ2UgfHwgJ05vIG1lc3NhZ2UnLFxuXHRcdFx0U3RhdHVzOiB0YXNrLnN0YXR1cyxcblx0XHRcdCdTdGFydGVkIEF0JzogdGFzay5zdGFydGVkQXQgfHwgJ05vdCBzdGFydGVkJyxcblx0XHRcdCdDb21wbGV0ZWQgQXQnOiB0YXNrLmNvbXBsZXRlZEF0IHx8ICdOb3QgY29tcGxldGVkJyxcblx0XHRcdER1cmF0aW9uOiB0YXNrLmR1cmF0aW9uIHx8ICdOL0EnLFxuXHRcdH0pKVxuXG5cdFx0Y29uc3Qgd29ya2Jvb2sgPSBYTFNYLnV0aWxzLmJvb2tfbmV3KClcblx0XHRjb25zdCB3b3Jrc2hlZXQgPSBYTFNYLnV0aWxzLmpzb25fdG9fc2hlZXQoZXhjZWxEYXRhKVxuXHRcdFhMU1gudXRpbHMuYm9va19hcHBlbmRfc2hlZXQod29ya2Jvb2ssIHdvcmtzaGVldCwgJ0NvbXBsZXRlZCBUYXNrcycpXG5cdFx0WExTWC53cml0ZUZpbGUod29ya2Jvb2ssICdDb21wbGV0ZWRfVGFza3NfUmVwb3J0Lnhsc3gnKVxuXHR9KVxuXG5cdC8vIEhhbmRsZSBsaXN0IHRvZ2dsaW5nXG5cdHZpZXdDb21wbGV0ZWRUYXNrc0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGFzay1saXN0Jykuc3R5bGUuZGlzcGxheSA9ICdub25lJ1xuXHRcdGNvbXBsZXRlZFRhc2tzU2VjdGlvbi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJ1xuXHR9KVxuXG5cdGJhY2tUb0FjdGl2ZVRhc2tzQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXHRcdGNvbXBsZXRlZFRhc2tzU2VjdGlvbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnXG5cdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRhc2stbGlzdCcpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snXG5cdH0pXG5cblx0Ly8gSGFuZGxlIHRhc2sgYWN0aW9uc1xuXHR0YXNrTGlzdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2ZW50ID0+IHtcblx0XHRjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXRcblx0XHRjb25zdCB0YXNrRWxlbWVudCA9IHRhcmdldC5jbG9zZXN0KCdsaScpXG5cdFx0Y29uc3QgdGFza0lkID0gdGFza0VsZW1lbnQuZGF0YXNldC5pZFxuXG5cdFx0Y29uc3QgdGFzayA9IHRhc2tzLmZpbmQodCA9PiB0LmlkID09PSB0YXNrSWQpXG5cdFx0aWYgKCF0YXNrKSByZXR1cm5cblxuXHRcdGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlZGl0LW1lc3NhZ2UtYnRuJykpIHtcblx0XHRcdGNvbnN0IG5ld01lc3NhZ2UgPSBwcm9tcHQoJ0VudGVyIG5ldyBtZXNzYWdlOicsIHRhc2subWVzc2FnZSB8fCAnJylcblx0XHRcdGlmIChuZXdNZXNzYWdlICE9PSBudWxsKSB7XG5cdFx0XHRcdHRhc2subWVzc2FnZSA9IG5ld01lc3NhZ2UudHJpbSgpXG5cdFx0XHRcdHN5bmNXaXRoU2VydmVyKCd1cGRhdGUnLCB0YXNrKVxuXHRcdFx0XHRyZW5kZXJBbGxUYXNrcygpXG5cdFx0XHR9XG5cdFx0fSBlbHNlIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdpbi1wcm9ncmVzcy1idG4nKSkge1xuXHRcdFx0dGFzay5zdGF0dXMgPSB0YXNrLnN0YXR1cyA9PT0gJ2luLXByb2dyZXNzJyA/ICduZXV0cmFsJyA6ICdpbi1wcm9ncmVzcydcblx0XHRcdGlmICh0YXNrLnN0YXR1cyA9PT0gJ2luLXByb2dyZXNzJyAmJiAhdGFzay5zdGFydGVkQXQpIHtcblx0XHRcdFx0dGFzay5zdGFydGVkQXQgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgLy8gUmVjb3JkIHRoZSBzdGFydCB0aW1lIHdoZW4gdGFzayBpcyBpbiBwcm9ncmVzc1xuXHRcdFx0fVxuXHRcdFx0c3luY1dpdGhTZXJ2ZXIoJ3VwZGF0ZScsIHRhc2spXG5cdFx0XHRyZW5kZXJBbGxUYXNrcygpXG5cdFx0fSBlbHNlIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjb21wbGV0ZWQtYnRuJykpIHtcblx0XHRcdHRhc2suc3RhdHVzID0gJ2NvbXBsZXRlZCdcblx0XHRcdHRhc2suY29tcGxldGVkQXQgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgLy8gUmVjb3JkIHRoZSBjb21wbGV0aW9uIHRpbWVcblx0XHRcdGlmICh0YXNrLnN0YXJ0ZWRBdCkge1xuXHRcdFx0XHRjb25zdCBkdXJhdGlvbkluTWludXRlcyA9IE1hdGgucm91bmQoKG5ldyBEYXRlKHRhc2suY29tcGxldGVkQXQpIC0gbmV3IERhdGUodGFzay5zdGFydGVkQXQpKSAvIDYwMDAwKSAvLyBDYWxjdWxhdGUgZHVyYXRpb24gaW4gbWludXRlc1xuXHRcdFx0XHR0YXNrLmR1cmF0aW9uID0gYCR7ZHVyYXRpb25Jbk1pbnV0ZXN9IG1pbmAgLy8gQWRkIHRoZSBcIm1pblwiIHN1ZmZpeFxuXHRcdFx0fVxuXHRcdFx0c3luY1dpdGhTZXJ2ZXIoJ3VwZGF0ZScsIHRhc2spXG5cdFx0XHRyZW5kZXJBbGxUYXNrcygpXG5cdFx0fSBlbHNlIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdhdHRlbnRpb24tYnRuJykpIHtcblx0XHRcdHRhc2suc3RhdHVzID0gdGFzay5zdGF0dXMgPT09ICdhdHRlbnRpb24nID8gJ25ldXRyYWwnIDogJ2F0dGVudGlvbidcblx0XHRcdHN5bmNXaXRoU2VydmVyKCd1cGRhdGUnLCB0YXNrKVxuXHRcdFx0cmVuZGVyQWxsVGFza3MoKVxuXHRcdH1cblx0fSlcblxuXHQvLyBSZXN0b3JlIHRhc2tzIGZyb20gY29tcGxldGVkXG5cdGNvbXBsZXRlZFRhc2tMaXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZXZlbnQgPT4ge1xuXHRcdGNvbnN0IHRhcmdldCA9IGV2ZW50LnRhcmdldFxuXG5cdFx0aWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3Jlc3RvcmUtYnRuJykpIHtcblx0XHRcdGNvbnN0IHRhc2tJZCA9IHRhcmdldC5jbG9zZXN0KCdsaScpLmRhdGFzZXQuaWRcblx0XHRcdGNvbnN0IHRhc2sgPSB0YXNrcy5maW5kKHQgPT4gdC5pZCA9PT0gdGFza0lkKVxuXG5cdFx0XHRpZiAodGFzaykge1xuXHRcdFx0XHR0YXNrLnN0YXR1cyA9ICduZXV0cmFsJ1xuXHRcdFx0XHRzeW5jV2l0aFNlcnZlcigndXBkYXRlJywgdGFzaylcblx0XHRcdFx0cmVuZGVyQWxsVGFza3MoKVxuXHRcdFx0fVxuXHRcdH1cblx0fSlcblxuXHQvLyBIYW5kbGUgZGVsZXRlIGFsbCB0YXNrcyB3aXRoIGNvbmZpcm1hdGlvblxuXHRkZWxldGVBbGxUYXNrc0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRpZiAoY29uZmlybSgnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSBhbGwgdGFza3M/IFRoaXMgYWN0aW9uIGNhbm5vdCBiZSB1bmRvbmUuJykpIHtcblx0XHRcdHRhc2tzID0gW10gLy8gQ2xlYXIgYWxsIHRhc2tzXG5cdFx0XHRzeW5jV2l0aFNlcnZlcignY2xlYXInLCBudWxsKSAvLyBPcHRpb25hbGx5IHNlbmQgY2xlYXIgYWN0aW9uIHRvIFdlYlNvY2tldCBzZXJ2ZXJcblx0XHRcdHJlbmRlckFsbFRhc2tzKClcblx0XHR9XG5cdH0pXG59KVxuIl19
